{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///C:/app-maginf/pages/api/chat.js"],"sourcesContent":["// API Route para integra√ß√£o com ChatGPT\nexport default async function handler(req, res) {\n  if (req.method !== 'POST') {\n    return res.status(405).json({ error: 'Method not allowed' });\n  }\n\n  const { message, conversationHistory = [] } = req.body;\n\n  if (!message) {\n    return res.status(400).json({ error: 'Message is required' });\n  }\n\n  try {\n    const OPENAI_API_KEY = process.env.OPENAI_API_KEY;\n\n    if (!OPENAI_API_KEY) {\n      console.error('OPENAI_API_KEY not configured');\n      return res.status(500).json({ \n        error: 'API key not configured',\n        fallback: getFallbackResponse(message)\n      });\n    }\n\n    // System prompt personalizado para MAGINF\n    const systemPrompt = `Voc√™ √© um assistente virtual da MAGINF Tecnologia, uma empresa especializada em servi√ßos de TI.\n\nINFORMA√á√ïES DA EMPRESA:\n- Nome: MAGINF Tecnologia\n- Especialidades: Servi√ßos Gerenciados (MSP), Cloud Computing, CFTV, Suporte 24/7\n- Localiza√ß√£o: Guarulhos, SP\n- Telefone: (11) 4610-6363\n- Email: sac@maginf.com.br\n- WhatsApp: (11) 4610-6363\n\nSERVI√áOS PRINCIPAIS:\n1. MSP (Managed Service Provider) - Gest√£o completa de TI\n2. Infraestrutura e Cloud - AWS, Azure, Microsoft 365\n3. CFTV e Seguran√ßa - C√¢meras IP com analytics\n4. Suporte T√©cnico 24/7 - Remoto e presencial\n5. Backup e Disaster Recovery\n6. Consultoria em TI\n\nPLANOS:\n- Bronze: Para PMEs (5-20 usu√°rios)\n- Prata: Para empresas m√©dias (20-50 usu√°rios)\n- Ouro: Para miss√£o cr√≠tica (50+ usu√°rios)\n\nDIFERENCIAIS:\n- Atendimento 24/7 com SLA garantido\n- Equipe certificada\n- Monitoramento proativo\n- Atendimento presencial em Guarulhos e regi√£o\n\nINSTRU√á√ïES:\n- Seja profissional, mas amig√°vel\n- Responda de forma clara e objetiva\n- Se n√£o souber algo espec√≠fico, sugira contato direto\n- Incentive o cliente a entrar em contato para or√ßamentos\n- Use emojis moderadamente para ser mais amig√°vel\n- Mantenha respostas concisas (m√°ximo 3 par√°grafos)`;\n\n    // Preparar mensagens para a API\n    const messages = [\n      { role: 'system', content: systemPrompt },\n      ...conversationHistory.map(msg => ({\n        role: msg.type === 'user' ? 'user' : 'assistant',\n        content: msg.text\n      })),\n      { role: 'user', content: message }\n    ];\n\n    // Chamar API do OpenAI\n    const response = await fetch('https://api.openai.com/v1/chat/completions', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${OPENAI_API_KEY}`\n      },\n      body: JSON.stringify({\n        model: 'gpt-3.5-turbo',\n        messages: messages,\n        max_tokens: 300,\n        temperature: 0.7,\n        presence_penalty: 0.6,\n        frequency_penalty: 0.3\n      })\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      console.error('OpenAI API error:', error);\n      \n      return res.status(200).json({\n        reply: getFallbackResponse(message),\n        source: 'fallback'\n      });\n    }\n\n    const data = await response.json();\n    const reply = data.choices[0].message.content;\n\n    return res.status(200).json({\n      reply: reply,\n      source: 'chatgpt'\n    });\n\n  } catch (error) {\n    console.error('Chat API error:', error);\n    \n    return res.status(200).json({\n      reply: getFallbackResponse(message),\n      source: 'fallback'\n    });\n  }\n}\n\n// Respostas de fallback caso a API falhe\nfunction getFallbackResponse(message) {\n  const lowerMessage = message.toLowerCase();\n\n  // Respostas espec√≠ficas\n  if (lowerMessage.includes('pre√ßo') || lowerMessage.includes('custo') || lowerMessage.includes('valor') || lowerMessage.includes('plano')) {\n    return 'üí∞ Nossos planos s√£o personalizados conforme suas necessidades! Entre em contato para uma proposta detalhada:\\n\\nüìß sac@maginf.com.br\\nüì± (11) 4610-6363';\n  }\n\n  if (lowerMessage.includes('suporte') || lowerMessage.includes('atendimento') || lowerMessage.includes('24')) {\n    return 'üõü Oferecemos suporte t√©cnico 24/7 com SLA garantido! Atendimento remoto e presencial quando necess√°rio. Nossa equipe est√° sempre dispon√≠vel para ajudar sua empresa.';\n  }\n\n  if (lowerMessage.includes('cloud') || lowerMessage.includes('nuvem') || lowerMessage.includes('azure') || lowerMessage.includes('aws')) {\n    return '‚òÅÔ∏è Trabalhamos com as principais plataformas cloud: AWS, Azure e Microsoft 365. Fazemos migra√ß√£o completa, gest√£o e otimiza√ß√£o de custos. Quer saber mais?';\n  }\n\n  if (lowerMessage.includes('cftv') || lowerMessage.includes('c√¢mera') || lowerMessage.includes('seguran√ßa') || lowerMessage.includes('camera')) {\n    return 'üìπ Instalamos sistemas CFTV IP profissionais com analytics de IA, acesso remoto e integra√ß√£o com NOC. Solicite um or√ßamento sem compromisso!';\n  }\n\n  if (lowerMessage.includes('backup') || lowerMessage.includes('recupera√ß√£o') || lowerMessage.includes('disaster')) {\n    return 'üíæ Oferecemos solu√ß√µes completas de backup e disaster recovery com criptografia e testes peri√≥dicos. Seus dados sempre seguros e recuper√°veis!';\n  }\n\n  if (lowerMessage.includes('msp') || lowerMessage.includes('gerenciado')) {\n    return 'üéØ Como MSP, gerenciamos toda sua infraestrutura de TI: servidores, rede, seguran√ßa, backup e suporte. Voc√™ foca no neg√≥cio, n√≥s cuidamos da tecnologia!';\n  }\n\n  if (lowerMessage.includes('contato') || lowerMessage.includes('falar') || lowerMessage.includes('ligar')) {\n    return 'üìû Entre em contato conosco:\\n\\nüìß Email: sac@maginf.com.br\\nüì± Telefone/WhatsApp: (11) 4610-6363\\nüìç Guarulhos, SP\\n\\nEstamos prontos para atender sua empresa!';\n  }\n\n  if (lowerMessage.includes('obrigado') || lowerMessage.includes('obrigada') || lowerMessage.includes('valeu')) {\n    return 'üòä Por nada! Estou aqui para ajudar. Se precisar de mais informa√ß√µes, √© s√≥ chamar. Quer falar com nossa equipe? Entre em contato: (11) 4610-6363';\n  }\n\n  if (lowerMessage.includes('oi') || lowerMessage.includes('ol√°') || lowerMessage.includes('ola') || lowerMessage.includes('bom dia') || lowerMessage.includes('boa tarde') || lowerMessage.includes('boa noite')) {\n    return 'üëã Ol√°! Seja bem-vindo √† MAGINF Tecnologia! Como posso ajudar voc√™ hoje? Posso falar sobre nossos servi√ßos, planos ou tirar d√∫vidas sobre TI.';\n  }\n\n  // Resposta gen√©rica\n  return 'ü§î Interessante! Para informa√ß√µes mais detalhadas sobre esse assunto, recomendo falar diretamente com nossa equipe especializada:\\n\\nüìß sac@maginf.com.br\\nüì± (11) 4610-6363\\n\\nPosso ajudar com mais alguma coisa?';\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}